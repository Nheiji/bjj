---
- name: Backup folder apps
  hosts: all
  gather_facts: true
  become: true
  tasks:    
    - name: Create a tar.gz archive of folder upload .
      community.general.archive:
        path: /var/www/html/upload
        dest: /tmp/backup-upload.tar.gz
        format: gz
        force_archive: true
      delegate_to: "10.100.10.70"

#    - name: copy to target
#      copy:
#        src: /tmp/backup-upload.tar.gz
#        dest: /tmp/backup-upload.tar.gz
#      remote_src: true
    - name: copy to temp folder
      fetch:
        src: /tmp/backup-upload.tar.gz
        dest: /tmp/backup-upload.tar.gz
      register: fetch_result
    - name: copy to temp folder
      copy:
        src: /tmp/backup-upload.tar.gz
        dest: /tmp/backup-upload.tar.gz
      delegate_to: 10.100.30.2
      remote_src: yes
#    - name: ls
#      command: ls -lh /tmp/
#      delegate_to: localhost
#      register: output
#    - debug:
#        msg: "{{ output }}"
#    - name:
       
