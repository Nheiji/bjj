---
- name: Create static ip
  hosts: localhost
  gather_facts: false
  vars:
    subnet: projects/poc-ansible-bjj/regions/asia-southeast2/subnetworks/bjj
    network: poc-ansible-bjj
  tasks:
    - name: Define subnetwork variables
      set_fact:
        subnetwork_config:
          name: bjj
          region: asia-southeast2
          ip_cidr_range: 10.100.50.0/24
          network: poc-ansible-bjj

    - name: create a static ip address
      google.cloud.gcp_compute_address:
        name: mystaticip
        region: asia-southeast2
        project: poc-ansible-bjj
        state: present
        address_type: INTERNAL
        address: "10.100.50.50"
        network: "{{ network }}"
        subnetwork:
          selfLink: bjj
      register: address

    - name: Print Reserved IP Address
      debug:
        var: address
